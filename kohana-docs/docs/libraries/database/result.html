<html xmlns="http://www.w3.org/1999/xhtml" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr" xml:lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>
    libraries:database:result    [Kohana User Guide]
</title><meta name="generator" content="DokuWiki Release 2008-05-05"><meta name="robots" content="index,follow"><meta name="date" content="2008-05-01T20:31:13-0500"><meta name="keywords" content="libraries,database,result"><link rel="search" type="application/opensearchdescription+xml" href="..\..\lib\exe\opensearch.html" title="Kohana User Guide"><link rel="start" href="/"><link rel="contents" href="result-1.html?do=index" title="Index"><link rel="alternate" type="application/rss+xml" title="Recent Changes" href="..\..\feed.html"><link rel="alternate" type="application/rss+xml" title="Current Namespace" href="..\..\feed-11.html?mode=list&amp;ns=libraries:database"><link rel="alternate" type="text/html" title="Plain HTML" href="..\..\_export\xhtml\libraries\database\result.html"><link rel="alternate" type="text/plain" title="Wiki Markup" href="..\..\_export\raw\libraries\database\result.html"><link rel="stylesheet" media="all" type="text/css" href="..\..\_css\all.css"><link rel="stylesheet" media="screen" type="text/css" href="..\..\_css\kohana.css"><link rel="stylesheet" media="print" type="text/css" href="..\..\_css\print.css"><script type="text/javascript" charset="utf-8" src="..\..\_js\script.js"></script><link rel="shortcut icon" href="..\..\lib\tpl\kohana\images\favicon.html"><link rel="stylesheet" type="text/css" href="..\..\_css\my.css"></head><body>
<!-- Start Header -->
<div id="header">

<!-- Start Logo -->
<a id="logo" href="..\contents.html"><img src="..\..\_img\kohana.png" alt="Kohana"></a>
<!-- End Logo -->

</div>
<!-- End Header -->

<div class="menu clearfix">
<ul><li class="top active"><a href="..\contents.html">Contents</a></li>


<li class="top"><a href="..\contents.html">General<!--[if IE 7]><!--></a><!--<![endif]-->
<!--[if lte IE 6]><table><tr><td><![endif]-->
	<ul><li><a href="..\..\general\configuration.html" title="Configuration">Configuration</a></li>
				<li><a href="..\..\general\controllers.html" title="Controllers">Controllers</a></li>
				<li><a href="..\..\general\errorhandling.html" title="Error Handling">Error Handling</a></li>
				<li><a href="..\..\general\events.html" title="Events">Events</a></li>
				<li><a href="..\..\general\filesystem.html" title="Filesystem">Filesystem</a></li>
				<li><a href="..\..\general\helpers.html" title="Helpers">Helpers</a></li>
				<li><a href="..\..\general\hooks.html" title="Hooks">Hooks</a></li>
				<li><a href="..\..\general\i18n.html" title="Internationalization">Internationalization</a></li>
				<li><a href="..\..\general\libraries.html" title="Libraries">Libraries</a></li>
				<li><a href="..\..\general\loading.html" title="Loading">Loading</a></li>
				<li><a href="..\..\general\logging.html" title="Logging">Logging</a></li>
				<li><a href="..\..\general\models.html" title="Models">Models</a></li>
				<li><a href="..\..\general\modules.html" title="Modules">Modules</a></li>
				<li><a href="..\..\general\routing.html" title="Routing">Routing</a></li>
				<li><a href="..\..\general\urls.html" title="URLs">URLs</a></li>
				<li><a href="..\..\general\views.html" title="Views">Views</a></li>
			</ul><!--[if lte IE 6]></td></tr></table></a><![endif]--></li>


<li class="top"><a href="..\contents.html">Core<!--[if IE 7]><!--></a><!--<![endif]-->
<!--[if lte IE 6]><table><tr><td><![endif]-->
	<ul><li><a href="..\core\benchmark.html" title="Benchmark">Benchmark</a></li>
				<li><a href="..\core\config.html" title="Config">Config</a></li>
				<li><a href="..\core\event.html" title="Event">Event</a></li>
				<li><a href="..\core\kohana.html" title="Kohana">Kohana</a></li>
				<li><a href="..\core\log.html" title="Log">Log</a></li>
				<li><a href="..\core\utf8.html" title="Unicode">Unicode</a></li>
				<li><a href="..\core\view.html" title="View">View</a></li>
			</ul><!--[if lte IE 6]></td></tr></table></a><![endif]--></li>


<li class="top"><a href="..\contents.html">Libraries<!--[if IE 7]><!--></a><!--<![endif]-->
<!--[if lte IE 6]><table><tr><td><![endif]-->
	<ul><li><a href="..\cache.html" title="Cache">Cache</a></li>
				<li><a href="..\calendar.html" title="Calendar">Calendar</a></li>
				<li><a href="..\captcha.html" title="Captcha">Captcha</a></li>
				<li><a href="..\database.html" title="Database">Database</a></li>
				<li><a href="..\encrypt.html" title="Encrypt">Encrypt</a></li>
				<li><a href="..\image.html" title="Image">Image</a></li>
				<li><a href="..\input.html" title="Input">Input</a></li>
				<li><a href="..\orm.html" title="ORM">ORM</a></li>
				<li><a href="..\pagination.html" title="Pagination">Pagination</a></li>
				<li><a href="..\profiler.html" title="Profiler">Profiler</a></li>
				<li><a href="..\session.html" title="Session">Session</a></li>
				<li><a href="..\uri.html" title="URI">URI</a></li>
				<li><a href="..\validation.html" title="Validation">Validation</a></li>
			</ul><!--[if lte IE 6]></td></tr></table></a><![endif]--></li>


<li class="top"><a href="..\contents.html">Helpers<!--[if IE 7]><!--></a><!--<![endif]-->
<!--[if lte IE 6]><table><tr><td><![endif]-->
	<ul><li><a href="..\..\helpers\arr.html" title="Array">Array</a></li>
				<li><a href="..\..\helpers\cookie.html" title="Cookie">Cookie</a></li>
				<li><a href="..\..\helpers\date.html" title="Date">Date</a></li>
				<li><a href="..\..\helpers\download.html" title="Download">Download</a></li>
				<li><a href="..\..\helpers\email.html" title="Email">Email</a></li>
				<li><a href="..\..\helpers\expires.html" title="Expires">Expires</a></li>
				<li><a href="..\..\helpers\feed.html" title="Feed">Feed</a></li>
				<li><a href="..\..\helpers\file.html" title="File">File</a></li>
				<li><a href="..\..\helpers\form.html" title="Form">Form</a></li>
				<li><a href="..\..\helpers\format.html" title="Format">Format</a></li>
				<li><a href="..\..\helpers\html.html" title="HTML">HTML</a></li>
				<li><a href="..\..\helpers\inflector.html" title="Inflector">Inflector</a></li>
				<li><a href="..\..\helpers\num.html" title="Num">Num</a></li>
				<li><a href="..\..\helpers\remote.html" title="Remote">Remote</a></li>
				<li><a href="..\..\helpers\request.html" title="Request">Request</a></li>
				<li><a href="..\..\helpers\security.html" title="Security">Security</a></li>
				<li><a href="..\..\helpers\text.html" title="Text">Text</a></li>
				<li><a href="..\..\helpers\upload.html" title="Upload">Upload</a></li>
				<li><a href="..\..\helpers\url.html" title="URL">URL</a></li>
				<li><a href="..\..\helpers\valid.html" title="Valid">Valid</a></li>
			</ul><!--[if lte IE 6]></td></tr></table></a><![endif]--></li>


</ul></div>


<!-- Start Body -->
<div id="body" class="dokuwiki clearfix">

<!-- wikipage start -->
<!-- TOC START -->
<!-- TOC END -->
<table class="inline"><tr class="row0"><th class="col0">Status</th><td class="col1">Draft</td>
	</tr><tr class="row1"><th class="col0">Todo</th><td class="col1">Expand</td>
	</tr></table><h1><a name="database_query_result" id="database_query_result">Database Query Result</a></h1>
<div class="level1">

<p>

Provides methods for handling database query results. There are several ways to do this.
</p>

</div>

<h2><a name="methods" id="methods">Methods</a></h2>
<div class="level2">

</div>

<h3><a name="result" id="result">result()</a></h3>
<div class="level3">

<p>

$query→result() is available automatically with default values when you execute a database query with <code>$this→db→get()</code> or <code> $this→db→query()</code>. As such, it is generally not needed to call this function unless you want to change the result set for your configuration defaults.
</p>

<p>
If you *do* need to change your defaults, simply run <code>$query→result()</code> with the following parameters:
</p>
<ul><li class="level1"><div class="li"> The first parameter is to use Objects (TRUE) or arrays (FALSE) in your result set.</div>
</li>
<li class="level1"><div class="li"> The second parameter is what type of object/array to use: For arrays, you can use MYSQL_ASSOC, MYSQL_NUM, or MYSQL_BOTH. For objects, you can specify a class name, and the library will create the specified object, if it exists, otherwise it will create stdObjects.</div>
</li>
</ul><pre class="code php"><span class="re1">$query</span> <span class="sy0">=</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">db</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">(</span><span class="st0">"SELECT `first_name`, `last_name`, `age` FROM `users`"</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="kw1">foreach</span> <span class="br0">(</span><span class="re1">$query</span> <span class="kw1">as</span> <span class="re1">$row</span><span class="br0">)</span>
<span class="br0">{</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="sy0">-&gt;</span><span class="me1">first_name</span><span class="sy0">;</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="sy0">-&gt;</span><span class="me1">last_name</span><span class="sy0">;</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="sy0">-&gt;</span><span class="me1">age</span><span class="sy0">;</span>
<span class="br0">}</span>
 
<span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">result</span><span class="br0">(</span><span class="kw2">FALSE</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="kw1">foreach</span> <span class="br0">(</span><span class="re1">$query</span> <span class="kw1">as</span> <span class="re1">$row</span><span class="br0">)</span>
<span class="br0">{</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="br0">[</span><span class="st0">'first_name'</span><span class="br0">]</span><span class="sy0">;</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="br0">[</span><span class="st0">'last_name'</span><span class="br0">]</span><span class="sy0">;</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="br0">[</span><span class="st0">'age'</span><span class="br0">]</span><span class="sy0">;</span>
<span class="br0">}</span></pre><pre class="code php"><span class="kw2">class</span> CircleObject
<span class="br0">{</span>
	<span class="kw2">function</span> area<span class="br0">(</span><span class="br0">)</span>
	<span class="br0">{</span>
		<span class="kw1">return</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">radius</span> <span class="sy0">*</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">radius</span> <span class="sy0">*</span> <span class="nu0">3.14</span><span class="sy0">;</span>
	<span class="br0">}</span>
<span class="br0">}</span>
 
<span class="sy0">----</span>
 
<span class="re1">$query</span> <span class="sy0">=</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">db</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">(</span><span class="st0">"SELECT `radius` FROM `circles`"</span><span class="br0">)</span><span class="sy0">;</span>
<span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">result</span><span class="br0">(</span><span class="kw2">TRUE</span><span class="sy0">,</span> <span class="st0">'CircleObject'</span><span class="br0">)</span><span class="sy0">;</span>
<span class="kw1">foreach</span> <span class="br0">(</span><span class="re1">$query</span> <span class="kw1">as</span> <span class="re1">$row</span><span class="br0">)</span>
<span class="br0">{</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="st0">'&lt;p&gt;'</span><span class="sy0">.</span><span class="re1">$row</span><span class="sy0">-&gt;</span><span class="me1">area</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">.</span><span class="st0">'&lt;/p&gt;'</span><span class="sy0">;</span>
<span class="br0">}</span></pre>
<p>
Note that the preferred way to iterate through result sets is with the result object. This is not an array, but an object with an internal pointer to return the current row. If you need a physical array of results, you can use the following method:
</p>

</div>

<h3><a name="result_array" id="result_array">result_array()</a></h3>
<div class="level3">

<p>

<code>$query→result_array()</code> the query result is returned as an array of results. You can then loop through them.
</p>

<p>
The parameters are the same as result().
</p>
<pre class="code php"><span class="re1">$query</span> <span class="sy0">=</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">db</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">(</span><span class="st0">"SELECT `first_name`, `last_name`, `age` FROM `users`"</span><span class="br0">)</span><span class="sy0">;</span>
 
<span class="kw1">foreach</span> <span class="br0">(</span><span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">result_array</span><span class="br0">(</span><span class="kw2">FALSE</span><span class="br0">)</span> <span class="kw1">as</span> <span class="re1">$row</span><span class="br0">)</span>
<span class="br0">{</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="br0">[</span><span class="st0">'first_name'</span><span class="br0">]</span><span class="sy0">;</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="br0">[</span><span class="st0">'last_name'</span><span class="br0">]</span><span class="sy0">;</span>
   <a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$row</span><span class="br0">[</span><span class="st0">'age'</span><span class="br0">]</span><span class="sy0">;</span>
<span class="br0">}</span></pre>
</div>

<h3><a name="insert_id" id="insert_id">insert_id()</a></h3>
<div class="level3">

<p>

<code>$query→insert_id()</code> returns the id of an INSERT statement. 
</p>
<pre class="code php"><span class="re1">$query</span> <span class="sy0">=</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">db</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">(</span><span class="st0">"INSERT"</span><span class="br0">)</span><span class="sy0">;</span>
 
<a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">insert_id</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<span class="co1">// 15</span></pre>
</div>

<h3><a name="count" id="count">count()</a></h3>
<div class="level3">

<p>

<code>$query→count()</code> counts the number of results from a query. 
</p>
<pre class="code php"><span class="re1">$query</span> <span class="sy0">=</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">db</span><span class="sy0">-&gt;</span><span class="me1">query</span><span class="br0">(</span><span class="st0">"SELECT * FROM table"</span><span class="br0">)</span><span class="sy0">;</span>
 
<a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">count</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<span class="co1">// 12</span></pre><hr><p>
You can also manually move the result pointer around in the result object with the following <a href="http://www.php.net/~helly/php/ext/spl/interfaceIterator.html" class="urlextern" title="http://www.php.net/~helly/php/ext/spl/interfaceIterator.html" rel="nofollow">iterator</a> methods:
</p>

</div>

<h3><a name="next" id="next">next()</a></h3>
<div class="level3">

<p>

Moves the result pointer ahead one.
</p>

</div>

<h3><a name="previous" id="previous">previous()</a></h3>
<div class="level3">

<p>

Moves the result pointer back one.
</p>

</div>

<h3><a name="rewind" id="rewind">rewind()</a></h3>
<div class="level3">

<p>

Moves the result pointer to the beginning.
</p>

</div>

<h3><a name="valid" id="valid">valid()</a></h3>
<div class="level3">

<p>

Determine if the current pointer location is a valid result pointer.
</p>

</div>

<h3><a name="current" id="current">current()</a></h3>
<div class="level3">

<p>

Returns the row of the current pointer position.
</p>
<pre class="code php"><span class="re1">$query</span> <span class="sy0">=</span> <span class="re1">$this</span><span class="sy0">-&gt;</span><span class="me1">db</span><span class="sy0">-&gt;</span><span class="me1">select</span><span class="br0">(</span><span class="st0">'title'</span><span class="br0">)</span><span class="sy0">-&gt;</span><span class="me1">from</span><span class="br0">(</span><span class="re1">$table</span><span class="br0">)</span><span class="sy0">-&gt;</span><span class="me1">get</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="st0">'First:'</span><span class="sy0">.</span>Kohana<span class="sy0">::</span><span class="me2">debug</span><span class="br0">(</span><span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">current</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">.</span><span class="st0">'&lt;br /&gt;'</span><span class="sy0">;</span>
 
<span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">next</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="st0">'Second:'</span><span class="sy0">.</span>Kohana<span class="sy0">::</span><span class="me2">debug</span><span class="br0">(</span><span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">current</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">.</span><span class="st0">'&lt;br /&gt;'</span><span class="sy0">;</span>
 
<span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">next</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="st0">'Third:'</span><span class="sy0">.</span>Kohana<span class="sy0">::</span><span class="me2">debug</span><span class="br0">(</span><span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">current</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span>
 
<a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="st0">'&lt;h3&gt;And we can reset it to the beginning:&lt;/h3&gt;'</span><span class="sy0">;</span>
<span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">rewind</span><span class="br0">(</span><span class="br0">)</span><span class="sy0">;</span>
<a href="http://www.php.net/echo"><span class="kw3">echo</span></a> <span class="st0">'Rewound:'</span><span class="sy0">.</span>Kohana<span class="sy0">::</span><span class="me2">debug</span><span class="br0">(</span><span class="re1">$query</span><span class="sy0">-&gt;</span><span class="me1">current</span><span class="br0">(</span><span class="br0">)</span><span class="br0">)</span><span class="sy0">;</span></pre>
<p>
The above example will print out single rows according to where the result pointer is located.

</p>

</div>

<!-- wikipage stop -->

</div>
<!-- End Body -->


<div id="wikibar" class="clearfix">
	<div class="meta">
		<div class="user">
					</div>
		<div class="doc">
			libraries/database/result.txt · Last modified: 2008/05/01 20:31 (external edit)			 
		</div>
	</div>

	</div>

<div id="footer"><strong>©2007-2008 Kohana Team. All rights reserved.</strong></div>


<div class="no"><img src="/lib/exe/indexer.php?id=libraries%3Adatabase%3Aresult&amp;1229411561" width="1" height="1" alt=""></div>
</body></html>
